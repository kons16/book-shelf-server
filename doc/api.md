# API

- ローカルでのエンドポイント `localhost:8000/api/v1/`
- リクエストは `application/json`
- `X-Auth-Token` は必ず付与する必要がある。
- ユーザー認証は Authorization ヘッダで `Bearer <token>` を付与
- テストが終わり次第、以下の表にチェックを入力する

## ユーザー

| url     | メソッド | 内容                | テスト |
| ------- | -------- | ------------------  | ------ |
| /user   | POST     | ユーザーの新規登録 |        |
| /user   | PUT      | ユーザー情報の編集 |        |
| /login  | POST     | ログイン           |        |
| /logout | POST     | ログアウト         |        |

<br>

## 本

| url      | メソッド | 内容            | テスト |
| -------- | -------- | --------------  | ------ |
| /my_book | POST     | 本棚に追加     |        |
| /my_book | GET      | 本棚の本を取得 |        |
| /my_book | DELETE   | 本棚から削除   |        |

<br>

<B>ユーザーが本棚に追加する流れ</B>

1. ユーザーが本棚に追加したい本の情報を送信。(/my_book POST)
1. その本の情報が books テーブルに入っているかチェック。
1. books テーブルに入っていなければ追加し、user_books テーブルに user_id と book_id を追加する。

<br><br>

## 各詳細

### /user POST ユーザーの新規登録

| パラメータ | 型     | 必須可否 | 内容                     |
| ---------- | ------ | -------- | ------------------------ |
| name       | string | 必須     | ユーザーのニックネーム   |
| email      | string | 必須     | ユーザーのメールアドレス |
| password   | number | 必須     | ユーザーのパスワード     |

<br>

レスポンス 200 OK
| パラメータ | 型 | 内容 |
| -------- | -------- | ------------ |
| session | string | セッション情報 |

<br><br>

### /user PUT ユーザー情報の更新

| パラメータ | 型     | 必須可否 | 内容                     |
| ---------- | ------ | -------- | ------------------------ |
| name       | string | 任意     | ユーザーのニックネーム   |
| email      | string | 任意     | ユーザーのメールアドレス |
| password   | number | 任意     | ユーザーのパスワード     |

<br>

レスポンス 200 OK
| パラメータ | 型 | 内容 |
| -------- | -------- | ------------ |

<br><br>

### /login POST ログイン

| パラメータ | 型     | 必須可否 | 内容                     |
| ---------- | ------ | -------- | ------------------------ |
| email      | string | 必須     | ユーザーのメールアドレス |
| password   | number | 必須     | ユーザーのパスワード     |

<br>

レスポンス 200 OK
| パラメータ | 型 | 内容 |
| -------- | -------- | ------------ |
| session | string | セッション情報 |

<br><br>

### /logout POST ログアウト

| パラメータ | 型  | 必須可否 | 内容 |
| ---------- | --- | -------- | ---- |

<br>

レスポンス 200 OK

| パラメータ | 型  | 内容 |
| ---------- | --- | ---- |

<br><br>

### /my_book POST 本棚に追加

| パラメータ | 型     | 必須可否 | 内容         |
| ---------- | ------ | -------- | ------------ |
| title      | string | 必須     | 本のタイトル |
| author     | string | 必須     | 著者         |

- 本を追加した日付はアプリ側で取得し、テーブルの cratedAt に保存

<br>

レスポンス 200 OK

| パラメータ | 型     | 内容         |
| ---------- | ------ | ------------ |
| title      | string | 本のタイトル |
| author     | string | 著者         |

<br><br>

### /my_book GET 本棚の本を取得

| パラメータ | 型     | 必須可否 | 内容           |
| ---------- | ------ | -------- | -------------- |
| date       | number | 任意     | 本を追加した月 |
| page       | number | 任意     | 取得件数       |

- date を指定すると、本棚にユーザーが本を追加した月の本を全件取得。形式は yyyymm
- page を指定すると、1page につき 10 件取得する。

```
{
    "date": 202002
    "page": 1
}
```

<br>

レスポンス 200 OK

| パラメータ | 型     | 内容                      |
| ---------- | ------ | ------------------------- |
| book_id    | string | books テーブルでの本の id |
| title      | string | 本のタイトル              |

<br><br>

### /my_book DELETE 本棚の本を削除

| パラメータ | 型     | 必須可否 | 内容    |
| ---------- | ------ | -------- | ------- |
| book_id    | string | 必須     | 本の id |

<br>

レスポンス 200 OK

| パラメータ | 型  | 内容 |
| ---------- | --- | ---- |
